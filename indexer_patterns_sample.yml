windows:evtx:powershell:
    name_rex: Windows_PowerShell.*\.jsonl$
    path_suffix: evtx
    host_path: "Event.System.Computer" # Extract the host from the event
    timestamp_path:  # Extract the timestamp from the event
      - "Event.System.TimeCreated.#attributes.SystemTime"
      - "Event.Timestamp"
    timestamp_format: "%Y-%m-%dT%H:%M:%S.%fZ" # Specify the timestamp format
    artifact: EVTX
evtx:
    name_rex: \.jsonl$
    path_suffix: evtx
    sourcetype: _json
    normalize:
      - normalize/windows/evtx.vrl
    host_path: ".host.name" # Extract the host AFTER VRL normalization from the event
    timestamp_path: # Extract the timestamp from the event AFTER VRL normalization
        - "timestamp"
    timestamp_format: "%Y-%m-%dT%H:%M:%SZ" # Timestamp after VRL normalization
prefetch:
    name_rex: \.jsonl$
    path_rex: ".*prefetch"
    sourcetype: _json
    host_rex: (^[\w-]+)-- # Extract host from file path
    normalize:
      - normalize/windows/prefetch.vrl
    timestamp_path: # Extract the host AFTER VRL normalization from the event
      - "timestamp" # Extract the timestamp from the event AFTER VRL normalization
    timestamp_format: "%Y-%m-%dT%H:%M:%SZ" # Timestamp after VRL normalization
reg:
    name_rex: --hives_hk
    host_rex: ([\w\.-]+)--
    sourcetype: _json
    normalize:
      - normalize/windows/hives.vrl                   
    timestamp_path:
      - "timestamp" 
    timestamp_format: "%Y-%m-%dT%H:%M:%SZ"